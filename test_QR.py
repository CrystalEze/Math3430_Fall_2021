import pytest
import QR

matrix_01 = [[1,0,5], [2,0,1]]
matrix_02 = [[1,0,1], [2,1,0]]
matrix_03 = [[2,2,1], [-2,1,2], [18,5,2]]
matrix_04 = [[1,2], [-5,2]]

def test_Stable_GramSchmidt():
    assert QR.Stable_GS(matrix_01) == [[[0.19611613513818404,0.0,0.9805806756909202], [0.98058067569092,0.0,-0.19611613513818404]],
                                       [[5.0990195135927845,1.3728129459672882,0], [0,1.7650452162436565,0]]]
    assert QR.Stable_GS(matrix_02) == [[[0.7071067811865475,0.0,0.7071067811865475], [0.577350269189626,0.5773502691896258,-0.5773502691896257]],
                                       [[1.4142135623730951,1.414213562373095,0], [0,1.7320508075688772,0]]]

def test_Orthonormal_Vectors():
    assert QR.Orthonormal_Vectors(matrix_01) == [[0.19611613513818404,0.0,0.9805806756909202], [0.98058067569092,0.0,-0.19611613513818404]]
    assert QR.Orthonormal_Vectors(matrix_02) == [[0.7071067811865475,0.0,0.7071067811865475], [0.577350269189626,0.5773502691896258,-0.5773502691896257]]

def test_Householder_Ortho():
    assert QR.Householder_QR(matrix_03) == [[[-0.6666666666666667, -0.6666666666666666,-0.3333333333333333], [-0.6666666666666666, 0.7333333333333334,-0.13333333333333333], [-0.3333333333333333,-0.3333333333333333,0.9333333333333333]],
                                            [[-3.0000000000000004,-1.1657341758564147e-16,1.5543122344752193e-16], [2.220446049250313e-16,-3.0,0.0], [-16.0000000000000004,9.0,-3.9999999999999996]]]
    assert QR.Householder_QR(matrix_04) == [[[-0.4472135954999581,-0.894427190999916], [0.894427190999916, -0.44721359549995787]],
                                            [[-2.23606797749979,2.22044604925031e-16], [0.44721359549995876,-5.366563145999495]]]