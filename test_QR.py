import pytest
import QR

matrix_01 = [[1,0,5], [2,0,1]]
matrix_02 = [[1,0,1], [2,1,0]]

def test_Unstable_GramSchmidt():
    assert QR.Unstable_GS(matrix_01) == [[[0.19611613513818404,0.0,0.9805806756909202], [0.98058067569092,0.0,-0.19611613513818404]],
                                         [[5.0990195135927845,1.3728129459672882,0], [0,1.7650452162436565,0]]]
    assert QR.Unstable_GS(matrix_02) == [[[0.7071067811865475,0.0,0.7071067811865475], [0.577350269189626,0.5773502691896258,-0.5773502691896257]],
                                         [[1.4142135623730951,1.414213562373095,0], [0,1.7320508075688772,0]]]

def test_Stable_GramSchmidt():
    assert QR.Stable_GS(matrix_01) == [[[0.19611613513818404,0.0,0.9805806756909202], [0.98058067569092,0.0,-0.19611613513818404]],
                                       [[5.0990195135927845,1.3728129459672882,0], [0,1.7650452162436565,0]]]
    assert QR.Stable_GS(matrix_02) == [[[0.7071067811865475,0.0,0.7071067811865475], [0.577350269189626,0.5773502691896258,-0.5773502691896257]],
                                       [[1.4142135623730951,1.414213562373095,0], [0,1.7320508075688772,0]]]

def test_Orthonormal_Vectors():
    assert QR.Orthonormal_Vectors(matrix_01) == [[0.19611613513818404,0.0,0.9805806756909202], [0.98058067569092,0.0,-0.19611613513818404]]
    assert QR.Orthonormal_Vectors(matrix_02) == [[0.7071067811865475,0.0,0.7071067811865475], [0.577350269189626,0.5773502691896258,-0.5773502691896257]]
